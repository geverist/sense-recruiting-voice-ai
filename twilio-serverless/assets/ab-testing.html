<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Voice A/B Testing - Sense</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      color: white;
      margin-bottom: 40px;
    }

    .header h1 {
      font-size: 3rem;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    .config-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 25px;
      margin-bottom: 30px;
    }

    .variant-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 35px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      position: relative;
    }

    .variant-card.variant-a {
      border-top: 5px solid #3b82f6;
    }

    .variant-card.variant-b {
      border-top: 5px solid #10b981;
    }

    .variant-label {
      position: absolute;
      top: -15px;
      left: 20px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 8px 20px;
      border-radius: 20px;
      font-weight: bold;
      font-size: 1.1rem;
    }

    .variant-a .variant-label {
      background: linear-gradient(135deg, #3b82f6, #2563eb);
    }

    .variant-b .variant-label {
      background: linear-gradient(135deg, #10b981, #059669);
    }

    .section-title {
      font-size: 1.5rem;
      color: #333;
      margin: 25px 0 15px 0;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-weight: 500;
      color: #555;
      margin-bottom: 8px;
    }

    select, input, textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    select:focus, input:focus, textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    textarea {
      resize: vertical;
      min-height: 100px;
      font-family: inherit;
    }

    .control-panel {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 35px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
      margin-bottom: 30px;
    }

    .control-title {
      font-size: 2rem;
      color: #333;
      margin-bottom: 25px;
      text-align: center;
    }

    .traffic-split {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 30px;
      padding: 20px;
      background: #f9fafb;
      border-radius: 12px;
    }

    .slider-container {
      flex: 1;
    }

    .slider {
      width: 100%;
      height: 8px;
      border-radius: 5px;
      background: linear-gradient(90deg, #3b82f6 0%, #10b981 100%);
      outline: none;
      -webkit-appearance: none;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    .slider::-moz-range-thumb {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: white;
      cursor: pointer;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      border: none;
    }

    .split-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-size: 0.9rem;
      color: #666;
    }

    .split-label {
      font-weight: bold;
    }

    .split-label.variant-a {
      color: #3b82f6;
    }

    .split-label.variant-b {
      color: #10b981;
    }

    .action-buttons {
      display: flex;
      gap: 15px;
      justify-content: center;
    }

    .btn {
      padding: 15px 35px;
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
    }

    .btn-secondary {
      background: #6b7280;
      color: white;
    }

    .btn-secondary:hover {
      background: #4b5563;
    }

    .results-section {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 16px;
      padding: 35px;
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.2);
    }

    .results-title {
      font-size: 2rem;
      color: #333;
      margin-bottom: 25px;
      text-align: center;
    }

    .results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .metric-card {
      background: #f9fafb;
      padding: 25px;
      border-radius: 12px;
      text-align: center;
    }

    .metric-label {
      font-size: 0.9rem;
      color: #666;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }

    .metric-value {
      font-size: 2.5rem;
      font-weight: bold;
      color: #667eea;
    }

    .metric-subtext {
      font-size: 0.85rem;
      color: #999;
      margin-top: 8px;
    }

    .winner-banner {
      background: linear-gradient(135deg, #10b981, #059669);
      color: white;
      padding: 25px;
      border-radius: 12px;
      text-align: center;
      font-size: 1.5rem;
      font-weight: bold;
      margin-bottom: 25px;
    }

    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    .comparison-table th {
      background: #f3f4f6;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      color: #333;
      border-bottom: 2px solid #e5e7eb;
    }

    .comparison-table td {
      padding: 15px;
      border-bottom: 1px solid #e5e7eb;
    }

    .comparison-table tr:hover {
      background: #f9fafb;
    }

    .better {
      color: #10b981;
      font-weight: bold;
    }

    .worse {
      color: #ef4444;
      font-weight: bold;
    }

    .help-text {
      background: #dbeafe;
      border-left: 4px solid #3b82f6;
      padding: 15px 20px;
      border-radius: 8px;
      margin: 20px 0;
      color: #1e40af;
      line-height: 1.6;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>🧪 Voice A/B Testing</h1>
      <p>Test different voice configurations to optimize candidate experience</p>
    </div>

    <div class="help-text">
      💡 <strong>How it works:</strong> Configure two different AI agent variants below. Calls will be randomly assigned to Variant A or B based on your traffic split. Track which variant performs better and use the winner for all future calls!
    </div>

    <div class="config-row">
      <!-- Variant A -->
      <div class="variant-card variant-a">
        <div class="variant-label">Variant A</div>

        <h3 class="section-title">Voice Configuration</h3>
        <div class="form-group">
          <label class="form-label">Voice Provider</label>
          <select id="voiceProviderA" onchange="updateVoiceOptionsA()">
            <option value="elevenlabs">ElevenLabs (Premium)</option>
            <option value="amazon-polly">Amazon Polly</option>
            <option value="google-tts">Google TTS</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Voice</label>
          <select id="voiceA">
            <option value="21m00Tcm4TlvDq8ikWAM">Rachel (Female, US - Calm)</option>
            <option value="AZnzlk1XvdvUeBnXmlld">Domi (Female, US - Confident)</option>
            <option value="EXAVITQu4vr4xnSDxMaL">Bella (Female, US - Pleasant)</option>
            <option value="ErXwobaYiN019PkySvjV">Antoni (Male, US - Warm)</option>
            <option value="TxGEqnHWrfWFTfGW9XjX">Josh (Male, US - Authoritative)</option>
          </select>
        </div>

        <h3 class="section-title">LLM Configuration</h3>
        <div class="form-group">
          <label class="form-label">Model</label>
          <select id="llmModelA">
            <option value="gpt-4o">GPT-4o (Best Quality)</option>
            <option value="gpt-4o-mini">GPT-4o-mini (Fast & Cheap)</option>
            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Temperature</label>
          <input type="number" id="temperatureA" value="0.7" min="0" max="1" step="0.1">
        </div>

        <h3 class="section-title">Prompt Style</h3>
        <div class="form-group">
          <label class="form-label">System Prompt</label>
          <textarea id="promptA" placeholder="You are a friendly recruiter...">You are a warm, professional recruiter conducting phone screenings. Be conversational and engaging while gathering key information about the candidate's experience and interest in the role.</textarea>
        </div>
      </div>

      <!-- Variant B -->
      <div class="variant-card variant-b">
        <div class="variant-label">Variant B</div>

        <h3 class="section-title">Voice Configuration</h3>
        <div class="form-group">
          <label class="form-label">Voice Provider</label>
          <select id="voiceProviderB" onchange="updateVoiceOptionsB()">
            <option value="elevenlabs">ElevenLabs (Premium)</option>
            <option value="amazon-polly">Amazon Polly</option>
            <option value="google-tts">Google TTS</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Voice</label>
          <select id="voiceB">
            <option value="onwK4e9ZLuTAKqWW03F9">Daniel (Male, British - Authoritative)</option>
            <option value="21m00Tcm4TlvDq8ikWAM">Rachel (Female, US - Calm)</option>
            <option value="AZnzlk1XvdvUeBnXmlld">Domi (Female, US - Confident)</option>
            <option value="ErXwobaYiN019PkySvjV">Antoni (Male, US - Warm)</option>
            <option value="TxGEqnHWrfWFTfGW9XjX">Josh (Male, US - Authoritative)</option>
          </select>
        </div>

        <h3 class="section-title">LLM Configuration</h3>
        <div class="form-group">
          <label class="form-label">Model</label>
          <select id="llmModelB">
            <option value="gpt-4o-mini">GPT-4o-mini (Fast & Cheap)</option>
            <option value="gpt-4o">GPT-4o (Best Quality)</option>
            <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
          </select>
        </div>

        <div class="form-group">
          <label class="form-label">Temperature</label>
          <input type="number" id="temperatureB" value="0.5" min="0" max="1" step="0.1">
        </div>

        <h3 class="section-title">Prompt Style</h3>
        <div class="form-group">
          <label class="form-label">System Prompt</label>
          <textarea id="promptB" placeholder="You are an efficient recruiter...">You are an efficient recruiting assistant. Keep responses brief and professional. Ask direct questions to quickly assess candidate qualifications and fit for the role.</textarea>
        </div>
      </div>
    </div>

    <div class="control-panel">
      <h2 class="control-title">⚙️ Test Configuration</h2>

      <div class="traffic-split">
        <div>
          <strong>Traffic Split:</strong><br>
          <span style="font-size: 0.9rem; color: #666;">Adjust what percentage of calls go to each variant</span>
        </div>
        <div class="slider-container">
          <input type="range" min="0" max="100" value="50" class="slider" id="trafficSlider" oninput="updateTrafficSplit()">
          <div class="split-labels">
            <span class="split-label variant-a">Variant A: <span id="splitA">50</span>%</span>
            <span class="split-label variant-b">Variant B: <span id="splitB">50</span>%</span>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label class="form-label">Minimum Sample Size</label>
        <input type="number" id="minSample" value="20" min="10" max="1000" placeholder="20">
        <small style="color: #666; display: block; margin-top: 5px;">
          Number of calls per variant before declaring a winner
        </small>
      </div>

      <div class="action-buttons">
        <button class="btn btn-primary" onclick="startTest()">🚀 Start A/B Test</button>
        <button class="btn btn-secondary" onclick="stopTest()">⏸️ Pause Test</button>
      </div>
    </div>

    <div class="results-section">
      <h2 class="results-title">📊 Test Results</h2>

      <div class="winner-banner" id="winnerBanner" style="display: none;">
        🏆 Winner: Variant A - 23% better performance!
      </div>

      <div class="results-grid">
        <div class="metric-card">
          <div class="metric-label">Variant A Calls</div>
          <div class="metric-value" id="callsA">0</div>
          <div class="metric-subtext">Total completed</div>
        </div>

        <div class="metric-card">
          <div class="metric-label">Variant B Calls</div>
          <div class="metric-value" id="callsB">0</div>
          <div class="metric-subtext">Total completed</div>
        </div>

        <div class="metric-card">
          <div class="metric-label">Statistical Significance</div>
          <div class="metric-value" id="significance">--</div>
          <div class="metric-subtext">Need 95% to declare winner</div>
        </div>
      </div>

      <table class="comparison-table">
        <thead>
          <tr>
            <th>Metric</th>
            <th>Variant A</th>
            <th>Variant B</th>
            <th>Better</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><strong>Avg Voice Naturalness</strong></td>
            <td id="naturalnessA">4.2 / 5</td>
            <td id="naturalnessB">3.8 / 5</td>
            <td class="better">Variant A (+11%)</td>
          </tr>
          <tr>
            <td><strong>Would Recommend</strong></td>
            <td id="recommendA">85%</td>
            <td id="recommendB">78%</td>
            <td class="better">Variant A (+9%)</td>
          </tr>
          <tr>
            <td><strong>Avg Call Duration</strong></td>
            <td id="durationA">4m 32s</td>
            <td id="durationB">3m 18s</td>
            <td class="better">Variant B (-27%)</td>
          </tr>
          <tr>
            <td><strong>Completion Rate</strong></td>
            <td id="completionA">92%</td>
            <td id="completionB">88%</td>
            <td class="better">Variant A (+5%)</td>
          </tr>
          <tr>
            <td><strong>Avg Sentiment Score</strong></td>
            <td id="sentimentA">Positive</td>
            <td id="sentimentB">Neutral</td>
            <td class="better">Variant A</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    function updateTrafficSplit() {
      const slider = document.getElementById('trafficSlider');
      const splitA = slider.value;
      const splitB = 100 - splitA;

      document.getElementById('splitA').textContent = splitA;
      document.getElementById('splitB').textContent = splitB;
    }

    function updateVoiceOptionsA() {
      const provider = document.getElementById('voiceProviderA').value;
      const voiceSelect = document.getElementById('voiceA');

      if (provider === 'elevenlabs') {
        voiceSelect.innerHTML = `
          <option value="21m00Tcm4TlvDq8ikWAM">Rachel (Female, US - Calm)</option>
          <option value="AZnzlk1XvdvUeBnXmlld">Domi (Female, US - Confident)</option>
          <option value="EXAVITQu4vr4xnSDxMaL">Bella (Female, US - Pleasant)</option>
          <option value="ErXwobaYiN019PkySvjV">Antoni (Male, US - Warm)</option>
          <option value="TxGEqnHWrfWFTfGW9XjX">Josh (Male, US - Authoritative)</option>
          <option value="onwK4e9ZLuTAKqWW03F9">Daniel (Male, British - Authoritative)</option>
        `;
      } else if (provider === 'amazon-polly') {
        voiceSelect.innerHTML = `
          <option value="Joanna">Joanna (Female, US)</option>
          <option value="Matthew">Matthew (Male, US)</option>
          <option value="Salli">Salli (Female, US)</option>
          <option value="Joey">Joey (Male, US)</option>
        `;
      } else if (provider === 'google-tts') {
        voiceSelect.innerHTML = `
          <option value="en-US-Neural2-A">Female (US - Neural)</option>
          <option value="en-US-Neural2-D">Male (US - Neural)</option>
          <option value="en-GB-Neural2-A">Female (British - Neural)</option>
          <option value="en-GB-Neural2-B">Male (British - Neural)</option>
        `;
      }
    }

    function updateVoiceOptionsB() {
      const provider = document.getElementById('voiceProviderB').value;
      const voiceSelect = document.getElementById('voiceB');

      if (provider === 'elevenlabs') {
        voiceSelect.innerHTML = `
          <option value="onwK4e9ZLuTAKqWW03F9">Daniel (Male, British - Authoritative)</option>
          <option value="21m00Tcm4TlvDq8ikWAM">Rachel (Female, US - Calm)</option>
          <option value="AZnzlk1XvdvUeBnXmlld">Domi (Female, US - Confident)</option>
          <option value="ErXwobaYiN019PkySvjV">Antoni (Male, US - Warm)</option>
          <option value="TxGEqnHWrfWFTfGW9XjX">Josh (Male, US - Authoritative)</option>
        `;
      } else if (provider === 'amazon-polly') {
        voiceSelect.innerHTML = `
          <option value="Matthew">Matthew (Male, US)</option>
          <option value="Joanna">Joanna (Female, US)</option>
          <option value="Joey">Joey (Male, US)</option>
          <option value="Salli">Salli (Female, US)</option>
        `;
      } else if (provider === 'google-tts') {
        voiceSelect.innerHTML = `
          <option value="en-US-Neural2-D">Male (US - Neural)</option>
          <option value="en-US-Neural2-A">Female (US - Neural)</option>
          <option value="en-GB-Neural2-B">Male (British - Neural)</option>
          <option value="en-GB-Neural2-A">Female (British - Neural)</option>
        `;
      }
    }

    function startTest() {
      const config = {
        variantA: {
          voiceProvider: document.getElementById('voiceProviderA').value,
          voice: document.getElementById('voiceA').value,
          llmModel: document.getElementById('llmModelA').value,
          temperature: parseFloat(document.getElementById('temperatureA').value),
          prompt: document.getElementById('promptA').value
        },
        variantB: {
          voiceProvider: document.getElementById('voiceProviderB').value,
          voice: document.getElementById('voiceB').value,
          llmModel: document.getElementById('llmModelB').value,
          temperature: parseFloat(document.getElementById('temperatureB').value),
          prompt: document.getElementById('promptB').value
        },
        trafficSplit: parseInt(document.getElementById('trafficSlider').value),
        minSampleSize: parseInt(document.getElementById('minSample').value)
      };

      console.log('Starting A/B test with config:', config);

      // In production, this would save to Twilio Sync
      localStorage.setItem('abTestConfig', JSON.stringify(config));
      alert('✅ A/B test started! Incoming calls will be randomly assigned to Variant A or B based on your traffic split.');
    }

    function stopTest() {
      if (confirm('Are you sure you want to pause the A/B test? Results so far will be preserved.')) {
        alert('⏸️ A/B test paused. No new calls will be assigned to variants.');
      }
    }

    // Simulate updating results (in production, this would fetch from Twilio Sync)
    function updateResults() {
      // Sample data - in production this comes from real call analytics
      document.getElementById('callsA').textContent = Math.floor(Math.random() * 30) + 20;
      document.getElementById('callsB').textContent = Math.floor(Math.random() * 30) + 20;
      document.getElementById('significance').textContent = '82%';
    }

    // Update results every 10 seconds
    setInterval(updateResults, 10000);
  </script>
</body>
</html>
